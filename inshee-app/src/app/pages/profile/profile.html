<div class="container">
  <!-- HEADER -->
  <div class="header">
    <h1>Perfil - {{ usuario.nome }}</h1>
    <button class="btn-logout" (click)="logout()">Sair</button>
  </div>

  <!-- CARD DE INFORMAÃ‡Ã•ES DO USUÃRIO -->
  <div class="card-usuario">
    <div class="foto-perfil">
      <div class="circulo-foto">ğŸ‘¤</div>
    </div>
    
    <div class="info-usuario">
      <p><strong>ğŸ“§ Email:</strong> {{ usuario.email }}</p>
      <p><strong>ğŸ“± Telefone:</strong> {{ usuario.telefone || 'NÃ£o informado' }}</p>
      <p><strong>ğŸ‚ Data de Nascimento:</strong> {{ usuario.dataNascimento }}</p>
      <p><strong>âš§ GÃªnero:</strong> {{ usuario.genero }}</p>
    </div>

    <div class="botoes-usuario">
      <button class="btn-editar" (click)="abrirEditarPerfil()">âœï¸ Editar Perfil</button>
      <button class="btn-senha" (click)="abrirTrocarSenha()">ğŸ” Trocar Senha</button>
    </div>
  </div>

  <!-- ABAS -->
  <div class="card">
    <div class="abas">
      <button 
        class="aba" 
        [class.ativa]="abaAtiva === 'ciclos'"
        (click)="trocarAba('ciclos')">
        ğŸ©¸ Ciclos
      </button>
      <button 
        class="aba" 
        [class.ativa]="abaAtiva === 'sintomas'"
        (click)="trocarAba('sintomas')">
        ğŸ’Š Sintomas
      </button>
      <button 
        class="aba" 
        [class.ativa]="abaAtiva === 'saude'"
        (click)="trocarAba('saude')">
        ğŸ©º SaÃºde
      </button>
      <button 
        class="aba" 
        [class.ativa]="abaAtiva === 'diario'"
        (click)="trocarAba('diario')">
        ğŸ“ DiÃ¡rio
      </button>
    </div>

    <!-- CONTEÃšDO DAS ABAS -->
    
    <!-- ABA CICLOS -->
    @if (abaAtiva === 'ciclos') {
      <div class="conteudo-aba">
        <div class="card-header">
          <h2>ğŸ©¸ Ciclos Menstruais</h2>
          <button class="btn-add" (click)="abrirFormulario()">+ Adicionar Ciclo</button>
        </div>

        <div class="ciclos-lista">
          @for (ciclo of ciclos; track ciclo.codigo) {
            <div class="ciclo-item">
              <div class="ciclo-info">
                <p><strong>ğŸ“… Data InÃ­cio:</strong> {{ ciclo.dataInicio }}</p>
                <p><strong>ğŸ”„ DuraÃ§Ã£o do Ciclo:</strong> {{ ciclo.duracaoCiclo }} dias</p>
                <p><strong>ğŸ©¸ MenstruaÃ§Ã£o:</strong> {{ ciclo.duracaoMenstruacao }} dias</p>
              </div>
              <div class="ciclo-acoes">
                <button class="btn-edit" (click)="editarCiclo(ciclo)">âœï¸ Editar</button>
                <button class="btn-delete" (click)="deletarCiclo(ciclo.codigo!)">ğŸ—‘ï¸ Excluir</button>
              </div>
            </div>
          }

          @if (ciclos.length === 0) {
            <div class="sem-ciclos">
              <p>ğŸ“ Nenhum ciclo registrado ainda!</p>
              <p>Clique em "Adicionar Ciclo" para comeÃ§ar.</p>
            </div>
          }
        </div>
      </div>
    }

    <!-- ABA SINTOMAS -->
    @if (abaAtiva === 'sintomas') {
      <div class="conteudo-aba">
        <h2>ğŸ’Š Sintomas</h2>
        <p class="em-desenvolvimento">ğŸš§ Em desenvolvimento...</p>
      </div>
    }

    <!-- ABA SAÃšDE -->
    @if (abaAtiva === 'saude') {
      <div class="conteudo-aba">
        <h2>ğŸ©º InformaÃ§Ãµes de SaÃºde</h2>
        <p class="em-desenvolvimento">ğŸš§ Em desenvolvimento...</p>
      </div>
    }

    <!-- ABA DIÃRIO -->
    @if (abaAtiva === 'diario') {
      <div class="conteudo-aba">
        <div class="card-header">
          <h2>ğŸ“ DiÃ¡rio Pessoal</h2>
          <button class="btn-add" (click)="abrirFormularioDiario()">+ Nova AnotaÃ§Ã£o</button>
        </div>

        <div class="diarios-lista">
          @for (diario of registrosDiarios; track diario.id) {
            <div class="diario-item">
              <div class="diario-header">
                <h3>{{ diario.titulo }}</h3>
                <span class="diario-data">ğŸ“… {{ diario.data }}</span>
              </div>
              <p class="diario-conteudo">{{ diario.conteudo }}</p>
              <div class="diario-acoes">
                <button class="btn-edit" (click)="editarDiario(diario)">âœï¸ Editar</button>
                <button class="btn-delete" (click)="deletarDiario(diario.id)">ğŸ—‘ï¸ Excluir</button>
              </div>
            </div>
          }

          @if (registrosDiarios.length === 0) {
            <div class="sem-ciclos">
              <p>ğŸ“ Nenhuma anotaÃ§Ã£o ainda!</p>
              <p>Clique em "Nova AnotaÃ§Ã£o" para comeÃ§ar seu diÃ¡rio.</p>
            </div>
          }
        </div>
      </div>
    }
  </div>

  <!-- POPUP FORMULÃRIO CICLO -->
  @if (mostrarFormulario) {
    <div class="formulario-overlay">
      <div class="formulario-card">
        <h3>{{ cicloSelecionado ? 'Editar Ciclo' : 'Novo Ciclo' }}</h3>
        
        <div class="form-group">
          <label>Data de InÃ­cio:</label>
          <input type="date" [(ngModel)]="dataInicio" required>
        </div>

        <div class="form-group">
          <label>DuraÃ§Ã£o do Ciclo (dias):</label>
          <input type="number" [(ngModel)]="duracaoCiclo" min="21" max="35" required>
        </div>

        <div class="form-group">
          <label>DuraÃ§Ã£o da MenstruaÃ§Ã£o (dias):</label>
          <input type="number" [(ngModel)]="duracaoMenstruacao" min="2" max="10" required>
        </div>

        <div class="form-buttons">
          <button class="btn-save" (click)="salvarCiclo()">Salvar</button>
          <button class="btn-cancel" (click)="fecharFormulario()">Cancelar</button>
        </div>
      </div>
    </div>
  }

  <!-- POPUP EDITAR PERFIL -->
  @if (mostrarEditarPerfil) {
    <div class="formulario-overlay">
      <div class="formulario-card">
        <h3>âœï¸ Editar Perfil</h3>
        
        <div class="form-group">
          <label>Nome:</label>
          <input type="text" [(ngModel)]="usuario.nome" required>
        </div>

        <div class="form-group">
          <label>Email:</label>
          <input type="email" [(ngModel)]="usuario.email" required>
        </div>

        <div class="form-group">
          <label>Telefone:</label>
          <input type="tel" [(ngModel)]="usuario.telefone" placeholder="(00) 00000-0000">
        </div>

        <div class="form-buttons">
          <button class="btn-save" (click)="salvarPerfil()">Salvar</button>
          <button class="btn-cancel" (click)="fecharEditarPerfil()">Cancelar</button>
        </div>
      </div>
    </div>
  }

  <!-- POPUP TROCAR SENHA -->
  @if (mostrarTrocarSenha) {
    <div class="formulario-overlay">
      <div class="formulario-card">
        <h3>ğŸ” Trocar Senha</h3>
        
        <div class="form-group">
          <label>Senha Atual:</label>
          <input type="password" placeholder="Digite sua senha atual">
        </div>

        <div class="form-group">
          <label>Nova Senha:</label>
          <input type="password" placeholder="Digite a nova senha">
        </div>

        <div class="form-group">
          <label>Confirmar Nova Senha:</label>
          <input type="password" placeholder="Confirme a nova senha">
        </div>

        <div class="form-buttons">
          <button class="btn-save" (click)="salvarSenha()">Salvar</button>
          <button class="btn-cancel" (click)="fecharTrocarSenha()">Cancelar</button>
        </div>
      </div>
    </div>
  }

  <!-- POPUP DIÃRIO -->
  @if (mostrarFormularioDiario) {
    <div class="formulario-overlay">
      <div class="formulario-card">
        <h3>{{ diarioSelecionado ? 'âœï¸ Editar AnotaÃ§Ã£o' : 'ğŸ“ Nova AnotaÃ§Ã£o' }}</h3>
        
        <div class="form-group">
          <label>Data:</label>
          <input type="date" [(ngModel)]="diarioData" required>
        </div>

        <div class="form-group">
          <label>TÃ­tulo:</label>
          <input type="text" [(ngModel)]="diarioTitulo" placeholder="Ex: Como me senti hoje" required>
        </div>

        <div class="form-group">
          <label>AnotaÃ§Ã£o:</label>
          <textarea [(ngModel)]="diarioConteudo" rows="6" placeholder="Escreva sobre seu dia, sentimentos, sintomas..."></textarea>
        </div>

        <div class="form-buttons">
          <button class="btn-save" (click)="salvarDiario()">Salvar</button>
          <button class="btn-cancel" (click)="fecharFormularioDiario()">Cancelar</button>
        </div>
      </div>
    </div>
  }
</div>